<!-- Generated by Claude Sonnet 4.5 (Anthropic) - December 2025 -->

# Jira MCP Server Setup Guide

This guide walks you through setting up the Atlassian MCP server for Jira integration with Claude Code.

## Overview

The Jira plugin requires the Atlassian MCP server to communicate with Jira. Claude Code manages the MCP server automatically through the `mcp.json` configuration file.

## Prerequisites

- **Podman or Docker** installed on your system
- **Jira account** with API access
- **Claude Code** installed

## Setup Steps

### Step 1: Get Your Jira Personal Access Token

1. Navigate to your Jira profile settings:
   - For Red Hat Jira: [Personal Access Tokens](https://issues.redhat.com/secure/ViewProfile.jspa?selectedTab=com.atlassian.pats.pats-plugin:jira-user-personal-access-tokens)
   - For other Jira instances: Settings → Profile → Personal Access Tokens

2. Click "Create token"

3. Set token name (e.g., "Claude Code MCP")

4. Set expiration (recommended: 1 year or longer)

5. **Copy the token immediately** (you won't be able to see it again)

### Step 2: Set Environment Variable for Token

**IMPORTANT:** Store the token in an environment variable, not in the mcp.json file.

Add to `~/.bashrc`, `~/.zshrc`, or equivalent:

```bash
export JIRA_PERSONAL_TOKEN="your-token-here"
```

Then reload your shell:
```bash
source ~/.bashrc  # or ~/.zshrc
```

**Why use environment variable?**
- Keeps sensitive tokens out of config files
- Prevents accidental token commits
- Allows easy token rotation

### Step 3: Create or Edit mcp.json

Claude Code reads MCP server configuration from `~/.claude/mcp.json`.

**Create the file if it doesn't exist:**

```bash
mkdir -p ~/.claude
touch ~/.claude/mcp.json
```

**Edit `~/.claude/mcp.json`** and add the Atlassian MCP server configuration:

```json
{
  "mcpServers": {
    "atlassian": {
      "command": "podman",
      "args": [
        "run",
        "--rm",
        "-i",
        "-e",
        "JIRA_URL",
        "-e",
        "JIRA_USERNAME",
        "-e",
        "JIRA_PERSONAL_TOKEN",
        "ghcr.io/sooperset/mcp-atlassian:latest",
        "--transport",
        "stdio"
      ],
      "env": {
        "JIRA_URL": "https://issues.redhat.com",
        "JIRA_USERNAME": "your-email@example.com"
      }
    }
  }
}
```

**Configuration fields:**
- `command`: Container runtime (`podman` or `docker`)
- `args`: Container run arguments
  - `--rm`: Remove container after exit
  - `-i`: Interactive mode (required for stdio transport)
  - `-e JIRA_URL/USERNAME/TOKEN`: Pass environment variables
  - `ghcr.io/sooperset/mcp-atlassian:latest`: Container image
  - `--transport stdio`: Use stdio transport (Claude Code manages lifecycle)
- `env`: Environment variables specific to this MCP server
  - `JIRA_URL`: Your Jira instance URL
  - `JIRA_USERNAME`: Your Jira email address
  - **Note:** `JIRA_PERSONAL_TOKEN` is NOT in env - it's passed from shell environment

**Customize for your setup:**
- Replace `https://issues.redhat.com` with your Jira URL
- Replace `your-email@example.com` with your Jira username/email
- Use `"command": "docker"` if you prefer Docker over Podman

### Step 4: Restart Claude Code

**IMPORTANT:** You must restart Claude Code for the MCP server configuration to be recognized.

```bash
# If running in a terminal
exit  # then start a new session

# If using IDE integration
# Restart your IDE or reload the Claude Code extension
```

**How it works:**
- Claude Code reads `~/.claude/mcp.json` on startup
- Automatically starts the atlassian MCP server container
- Manages container lifecycle (starts/stops with Claude Code)
- Uses stdio transport for communication

### Step 5: Verify the Setup

Test that Claude Code can communicate with the MCP server:

Try a simple Jira command:

```bash
/jira:create story MYPROJECT "Test issue"
```

**Expected behavior:**
- Claude Code starts the atlassian container automatically
- You're prompted for issue details
- The command completes successfully

**If you see "MCP tools not available":**
- Check that mcp.json is in the correct location: `~/.claude/mcp.json`
- Verify JIRA_PERSONAL_TOKEN environment variable is set
- Restart Claude Code
- See Troubleshooting section below

## Troubleshooting

### "MCP tools not available"

**Check 1: Is mcp.json in the correct location?**
```bash
ls -la ~/.claude/mcp.json
```
Should exist and be readable.

**Check 2: Is the JSON valid?**
```bash
cat ~/.claude/mcp.json | jq .
```
Should parse without errors. If you get a JSON error, fix the syntax.

**Check 3: Is the token environment variable set?**
```bash
echo $JIRA_PERSONAL_TOKEN
```
Should output your token (not empty).

**Check 4: Did you restart Claude Code?**
After editing mcp.json, you **must** restart Claude Code.

**Check 5: Can podman/docker run?**
```bash
podman --version  # or docker --version
```
Should output version number.

### "Authentication failed"

**Check 1: Token valid?**
- Tokens expire based on the expiration you set
- Generate a new token and update `JIRA_PERSONAL_TOKEN`

**Check 2: Username correct?**
- Should be your Jira email address
- Check `JIRA_USERNAME` in mcp.json

**Check 3: URL correct?**
- Must include protocol: `https://` not just `issues.redhat.com`
- No trailing slash
- Check `JIRA_URL` in mcp.json

### "Container fails to start"

**Check 1: Container image available?**
```bash
podman pull ghcr.io/sooperset/mcp-atlassian:latest
```
Should download the image successfully.

**Check 2: Podman Machine running? (macOS)**
```bash
podman machine start
```
Required on macOS before using podman.

**Check 3: Docker daemon running?**
```bash
docker info
```
Should show docker information.

### "Rate limited by Jira"

Jira has API rate limits. If you hit them:
- Wait a few minutes
- Reduce frequency of requests
- Check if you have multiple processes hitting the API

### Container logs show errors

To see container output:
```bash
# Add verbose logging to mcp.json args
"args": [
  "run",
  "--rm",
  "-i",
  "-e",
  "JIRA_URL",
  "-e",
  "JIRA_USERNAME",
  "-e",
  "JIRA_PERSONAL_TOKEN",
  "ghcr.io/sooperset/mcp-atlassian:latest",
  "--transport",
  "stdio",
  "-vv"  # Add this for verbose logging
]
```

Then check Claude Code logs for container output.

## Security Considerations

### Token Security

- **Never commit tokens to git** - Always use environment variables
- **Use .gitignore for mcp.json** - Add `~/.claude/mcp.json` to global gitignore
- **Rotate tokens regularly** - Generate new tokens every 3-6 months
- **Set appropriate expiration** - Balance convenience vs security

**Example .gitignore pattern:**
```text
# Claude Code configuration
.claude/mcp.json
mcp.json
```

### Configuration File Security

The mcp.json should:
- **Not contain tokens** - Use environment variables instead
- **Be readable only by you** - `chmod 600 ~/.claude/mcp.json`
- **Not be committed to version control**

Verify permissions:
```bash
ls -la ~/.claude/mcp.json
# Should show: -rw------- (readable/writable by you only)
```

### Pre-commit Hooks

Consider using [rh-pre-commit](https://source.redhat.com/departments/it/it_information_security/leaktk/leaktk_components/rh_pre_commit) to scan for accidentally committed secrets:

```bash
pip install rh-pre-commit
rh-pre-commit install
```

## Plugin Configuration

The Jira plugin stores setup status in `~/.claude/jira-config.json`:

```json
{
  "default_security_level": "Red Hat Employee",
  "skip_security_confirmation": false,
  "mcp_setup_complete": false
}
```

**Fields:**
- `default_security_level`: Global default for issue security levels
- `skip_security_confirmation`: Whether to prompt when security differs from default
- `mcp_setup_complete`: Whether the user has completed MCP server setup walkthrough

**Do not edit this file manually** - the plugin manages it automatically.

## Advanced Configuration

### Custom Container Image

To use a custom MCP server image, replace the image name in the `args` array:

```json
"localhost/my-custom-mcp-atlassian:latest"
```

Instead of:
```json
"ghcr.io/sooperset/mcp-atlassian:latest"
```

### Additional Environment Variables

To add custom environment variables (e.g., SSL verification):

1. Add to the `args` array:
   ```json
   "-e",
   "JIRA_SSL_VERIFY"
   ```

2. Set in the `env` object:
   ```json
   "JIRA_SSL_VERIFY": "true"
   ```

3. Export in your shell:
   ```bash
   export JIRA_SSL_VERIFY="true"
   ```

## Next Steps

Once setup is complete, explore the Jira plugin commands:

- `/jira:create` - Create issues with guided workflows
- `/jira:solve` - Analyze and solve Jira issues
- `/jira:status-rollup` - Generate status updates
- `/jira:grooming` - Prepare grooming meetings

See the [main README](../README.md) for full command documentation.
