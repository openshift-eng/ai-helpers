<!-- Generated by Claude Sonnet 4.5 (Anthropic) - December 2025 -->

# Task Guide

Guide on Jira Tasks: what they are, when to use them, and best practices.

## Usage

```bash
# Create a task (uses common/task.yaml template by default)
/jira:create task OCPBUGS "Refactor metrics collection logic"

# Override with a specific template
/jira:create task OCPBUGS "Refactor metrics" --template common/task
```

**Templates:** For more information on templates, see the [Template Guide](../../templates/README.md).

---

## What is a Task?

A Jira task is:
- **Technical or operational work** that doesn't necessarily deliver direct user-facing value
- **Internal improvement** work like refactoring, infrastructure, or configuration
- **Enabler work** that supports future stories but isn't user-visible itself
- **Investigation or research** to understand a problem or evaluate options

### Task Characteristics

Tasks should:
- Focus on **technical implementation** or operational work
- **Not deliver direct user value** (if it does, use a Story instead)
- Be **completable in a reasonable time** (days, not weeks)
- Have **clear acceptance criteria** that define when the work is done
- Include **technical context** to help implementers understand the work

## Task vs Story

### When to Use a Task

Use a **Task** when the work is:
- **Technical/operational** - Infrastructure, refactoring, configuration
- **Not user-facing** - No direct end-user functionality
- **Internal improvement** - Code quality, performance, maintenance
- **Enabler work** - Supports future stories but isn't user-visible

**Examples of tasks:**
- "Update scaling documentation"
- "Refactor authentication utility package"
- "Configure CI pipeline for integration tests"
- "Upgrade dependency X to version Y"
- "Investigate performance regression in component Z"

### When to Use a Story Instead

Use a **Story** when the work:
- Delivers user-facing functionality
- Can be expressed as "As a... I want... so that..."
- Has business value to end users
- Is part of a user workflow

**If in doubt:** Ask "Would an end user notice or care about this change?"
- **Yes** → Story
- **No** → Task

### Comparison Table

| Aspect | Task | Story |
|--------|------|-------|
| **Audience** | Internal (developers, operators) | End users |
| **Value** | Technical improvement | User-facing functionality |
| **Format** | Action-oriented description | "As a... I want... So that..." |
| **Examples** | Refactor code, update docs, configure CI | Add feature, improve UI, enable workflow |
| **Visibility** | Not observable by end users | Observable by end users |

## Task Best Practices

### 1. Clear Summary

The summary should:
- Be concise (one sentence, 5-10 words)
- Use action verbs (Update, Refactor, Configure, Investigate, Fix)
- Identify what is being changed
- Optionally include "why" if not obvious

**Good examples:**
- ✅ "Update autoscaling documentation for 4.21 release"
- ✅ "Refactor scaling controller to reduce code duplication"
- ✅ "Configure Prometheus alerts for control plane memory usage"
- ✅ "Investigate intermittent timeout in etcd health checks"

**Bad examples:**
- ❌ "Do some work on docs" (too vague)
- ❌ "Technical debt" (not specific)
- ❌ "Various improvements" (not actionable)

### 2. Detailed Description

The description should include:

1. **What needs to be done** - Clear statement of the work
2. **Why it's needed** - Context or motivation
3. **Acceptance criteria** (optional but recommended) - How to know it's done
4. **Technical details** (if helpful) - Specific files, commands, approaches

**Example:**
```text
Update the autoscaling documentation to reflect changes in the 4.21 release.

Why: The autoscaling API changed in 4.21 with new fields and behavior.
Documentation currently reflects 4.20 and will confuse users.

Acceptance Criteria:
- All autoscaling examples updated to use 4.21 API
- New fields documented with descriptions and examples
- Deprecated fields marked as deprecated
- Documentation builds without warnings

Files to update:
- docs/content/how-to/autoscaling.md
- docs/content/reference/api.md
```

### 3. Explain Why

Always include motivation or context:
- What prompted this work?
- What will improve after this is done?
- Is this addressing a specific issue or enabling future work?

**Example:**
```text
Why: Code duplication makes maintenance difficult. When validation logic
changes, we have to update it in three places, which is error-prone.
Consolidating into a shared utility will make the code easier to maintain
and reduce bugs.
```

### 4. Add Acceptance Criteria

Even for tasks, acceptance criteria helps define "done":

**For technical tasks, AC might include:**
- Tests passing
- Documentation updated
- Code review completed
- Specific functionality working

**Example:**
```text
Acceptance Criteria:
- Validation logic extracted to support/validation package
- All three controllers updated to use shared validation
- Existing tests pass
- New unit tests added for validation utility
- Code review approved
```

### 5. Include Technical Details

When helpful, provide specific technical information:
- Files to modify
- Dependencies on other work
- Suggested implementation approach
- Related issues or PRs

**Example:**
```text
Files to modify:
- hypershift/operator/controllers/nodepool/autoscaling.go
- hypershift/operator/controllers/hostedcluster/autoscaling.go
- hypershift/operator/controllers/manifests/autoscaling.go
- hypershift/support/validation/autoscaling.go (new)

Dependencies:
- Must complete after PROJ-100 (validation refactor epic)

Approach:
- Extract common validation functions to support/validation
- Add comprehensive unit tests for new package
- Update controllers to import and use new package
- Remove duplicated code
```

### 6. Right Size

Task should be completable in reasonable time:
- **Too small:** <1 hour → Consider just doing it
- **Just right:** 1-5 days → Good task size
- **Too large:** >1 week → Split into multiple tasks

### 7. Link to Parent

If task supports a story/epic, link it:
- Provides context for the task
- Shows how it fits into larger work
- Helps with planning and tracking

## Task Types

### Documentation Task

**Characteristics:**
- Updates or creates documentation
- Often related to API changes or new features
- AC includes docs building successfully

**Example:**
```text
Summary: "Update autoscaling documentation for 4.21 release"

Description:
Update the autoscaling documentation to reflect API changes in the 4.21 release.

**Why**

The autoscaling API changed in 4.21 with new fields (maxNodeGracePeriod,
scaleDownDelay) and modified behavior. Current documentation reflects 4.20
API and will confuse users upgrading to 4.21.

**Acceptance Criteria**

* All autoscaling examples updated to use 4.21 API syntax
* New fields documented with descriptions and examples
* Deprecated fields marked as deprecated with migration guidance
* Documentation builds successfully without warnings

**Technical Details**

Files to update:
* docs/content/how-to/cluster-autoscaling.md
* docs/content/reference/api/nodepool.md
* docs/content/tutorials/autoscaling-rosa.md

Reference: API changes introduced in PR #1234
```

### Refactoring Task

**Characteristics:**
- Improves code quality without changing functionality
- Reduces technical debt
- Often includes extracting common code

**Example:**
```text
Summary: "Refactor scaling controller to reduce code duplication"

Description:
Extract common validation logic from scaling controllers into a shared
utility package.

**Why**

Validation code is currently duplicated across three controller files. This
makes maintenance difficult and error-prone. When validation logic changes,
we have to update it in three places.

**Acceptance Criteria**

* Validation logic extracted to support/validation package
* All three controllers updated to use shared validation
* Existing tests pass
* New unit tests added for validation utility
* Code coverage maintained or improved
* Code review approved

**Technical Details**

Files to modify:
* hypershift/operator/controllers/nodepool/autoscaling.go
* hypershift/operator/controllers/hostedcluster/autoscaling.go
* hypershift/operator/controllers/manifests/autoscaling.go
* hypershift/support/validation/autoscaling.go (new)

Approach:
* Identify common validation patterns
* Extract to support/validation with comprehensive tests
* Update controllers to use new package
* Remove duplicated code
```

### Configuration Task

**Characteristics:**
- Sets up infrastructure or tooling
- Configures CI/CD pipelines
- Establishes monitoring or alerting

**Example:**
```text
Summary: "Configure Prometheus alerts for control plane memory usage"

Description:
Set up Prometheus alerting rules to notify when control plane components
exceed memory thresholds.

**Why**

Recent incidents involved control plane components running out of memory.
Proactive alerting will help catch issues before they cause outages.

**Acceptance Criteria**

* Alert rules created for kube-apiserver, etcd, controller-manager
* Alerts trigger at 80% and 95% memory usage
* Alerts integrate with PagerDuty
* Alerts tested in staging environment
* Documentation updated with alert response procedures

**Technical Details**

Files to create/modify:
* monitoring/alerts/control-plane-memory.yaml

Alert thresholds:
* Warning: 80% memory usage for 5 minutes
* Critical: 95% memory usage for 2 minutes

Related: SRE runbook RUNBOOK-456
```

### Investigation Task

**Characteristics:**
- Researches a problem or evaluates options
- Outcome is understanding, not code changes
- AC includes documenting findings

**Example:**
````text
Summary: "Investigate intermittent timeouts in etcd health checks"

Description:
Investigate intermittent timeout errors occurring in etcd health checks on
ROSA HCP clusters.

**Why**

Users report clusters occasionally showing unhealthy status despite normal
operation. Logs show intermittent timeout errors from etcd health checks
(~5% of checks fail).

**Acceptance Criteria**

* Root cause identified and documented
* Recommendation provided (fix, workaround, or "no action needed")
* Findings shared with team in investigation summary
* Follow-up tasks created if fixes are needed

**Technical Details**

Error pattern:
```text
etcd health check failed: context deadline exceeded (timeout: 2s)
```

Frequency: ~5% of health checks
Affected clusters: ROSA HCP in us-east-1
Logs to review: control-plane-operator, etcd-operator

Related issues: OCPBUGS-1234 (similar symptoms)

Investigation areas:
* Network latency between components
* Resource contention on control plane nodes
* etcd performance metrics
* Health check timeout configuration
```

### Dependency Upgrade Task

**Characteristics:**
- Updates libraries or dependencies
- Includes testing and validation
- May require code changes for compatibility

**Example:**
```text
Summary: "Upgrade Kubernetes client-go to v0.28.0"

Description:
Upgrade the Kubernetes client-go library from v0.27.2 to v0.28.0 to get
latest bug fixes and API compatibility.

**Why**

Version 0.28.0 includes important fixes for list/watch performance and
adds support for Kubernetes 1.28 APIs. Current version has known issues
with high-cardinality watches.

**Acceptance Criteria**

* client-go upgraded to v0.28.0 in go.mod
* All direct usages updated for API changes
* go mod tidy and go mod vendor completed
* Unit tests pass
* Integration tests pass
* E2E tests pass in CI

**Technical Details**

Breaking changes:
* Context parameter now required for all client methods
* Some deprecated APIs removed

Files likely affected:
* go.mod, go.sum
* hypershift/operator/controllers/**/*.go (client usage)

Migration guide: https://github.com/kubernetes/client-go/blob/master/CHANGELOG.md
````

## Anti-Patterns to Avoid

### ❌ Vague Summaries

**Example:**
```text
"Update stuff"
"Fix things"
"Technical debt"
```

**Why bad:** Not specific, not actionable, doesn't communicate what's changing

**Fix:** Be specific:
```text
"Update autoscaling documentation for 4.21 API changes"
"Refactor validation logic to eliminate code duplication"
"Fix memory leak in controller reconciliation loop"
```

---

### ❌ User-Facing Work as Tasks

**Example:**
```text
"Add user dashboard feature"
"Enable users to configure autoscaling via UI"
```

**Why bad:** These deliver user value and should be Stories

**Fix:** Create as a Story:
```text
As a cluster admin, I want to configure autoscaling via the web console,
so that I don't need to use CLI tools.
```

---

### ❌ Too Large

**Example:**
```text
"Refactor entire codebase"
"Update all documentation"
"Fix all technical debt"
```

**Why bad:** Takes weeks/months, can't complete in reasonable time

**Fix:** Break into smaller, focused tasks:
```text
"Refactor scaling controller validation logic"
"Update autoscaling documentation for 4.21 changes"
"Refactor authentication utility package"
```

---

### ❌ No Context

**Example:**
```text
Summary: "Update docs"
Description: <empty>
```

**Why bad:** No one knows why this is needed or what specifically should change

**Fix:** Always explain why and what:
```text
Summary: "Update autoscaling documentation for 4.21 release"

Description:
Update the autoscaling documentation to reflect API changes in the 4.21
release.

**Why**

The autoscaling API changed in 4.21 with new fields and behavior. Current
documentation reflects 4.20 and will confuse users.

**Acceptance Criteria**

* All autoscaling examples updated to use 4.21 API
* New fields documented
* Documentation builds successfully
```

---

### ❌ No Acceptance Criteria

**Example:**
```text
Description: Refactor the validation code.
```

**Why bad:** Unclear when the work is "done"

**Fix:** Add clear AC:
```text
**Acceptance Criteria**

* Validation logic extracted to support/validation package
* All controllers use shared validation
* Tests pass
* Code coverage maintained
* Code review approved
```

---

### ❌ Implementation Details Only

**Example:**
```text
Description:
Change line 45 in autoscaling.go from X to Y.
Update function signature on line 123.
```

**Why bad:** Describes "how" without "why", too prescriptive

**Fix:** Describe what and why, not exact implementation:
```text
Description:
Refactor validation logic to eliminate code duplication.

**Why**

Three controllers have identical validation code. Consolidating reduces
maintenance burden and prevents divergence.

**Acceptance Criteria**

* Validation extracted to shared utility
* All controllers use shared validation
* Tests pass
```

## Task Quality Checklist

Before creating a task, verify:

- ✅ Summary is clear and specific (uses action verb)
- ✅ Work is technical/operational (not user-facing)
- ✅ Description explains what needs to be done
- ✅ Description includes why (motivation/context)
- ✅ Acceptance criteria present (how to know it's done)
- ✅ Technical details included if helpful
- ✅ Task is right-sized (completable in days, not weeks)
- ✅ No sensitive data (credentials, secrets, API keys)
- ✅ Linked to parent story/epic if applicable

## Examples

### Example 1: Documentation Task

**Summary:** "Update autoscaling documentation for 4.21 release"

**Description:**
```text
Update the autoscaling documentation to reflect API changes in the 4.21 release.

**Why**

The autoscaling API changed in 4.21 with new fields (maxNodeGracePeriod,
scaleDownDelay) and modified behavior. Current documentation reflects 4.20
API and will confuse users upgrading to 4.21.

**Acceptance Criteria**

* All autoscaling examples updated to use 4.21 API syntax
* New fields documented with descriptions and examples
* Deprecated fields marked as deprecated with migration guidance
* Documentation builds successfully without warnings or broken links
* Changes reviewed by docs team

**Technical Details**

Files to update:
* docs/content/how-to/cluster-autoscaling.md
* docs/content/reference/api/nodepool.md
* docs/content/tutorials/autoscaling-rosa.md

Reference: API changes introduced in PR #1234
```

---

### Example 2: Refactoring Task

**Summary:** "Refactor validation logic to reduce duplication"

**Description:**
```text
Extract common validation code from three controller files into a shared utility package.

**Why**

Validation logic is currently duplicated across nodepool, hostedcluster, and
manifests controllers. This makes maintenance difficult and error-prone. When
validation rules change, we must update all three locations.

**Acceptance Criteria**

* Validation logic extracted to support/validation package
* All three controllers updated to use shared validation
* Existing tests pass
* New unit tests added for validation utility (>80% coverage)
* Code review approved

**Technical Details**

Files to modify:
* hypershift/operator/controllers/nodepool/autoscaling.go
* hypershift/operator/controllers/hostedcluster/autoscaling.go
* hypershift/operator/controllers/manifests/autoscaling.go
* hypershift/support/validation/autoscaling.go (new)

Approach:
* Identify common validation patterns across controllers
* Extract to support/validation with comprehensive unit tests
* Update controllers to import and use new package
* Remove duplicated code
* Verify all existing tests still pass
```

---

### Example 3: Configuration Task

**Summary:** "Configure CI pipeline for integration tests"

**Description:**
```text
Set up GitHub Actions workflow to run integration tests on every PR.

**Why**

Integration tests currently run only manually. Automating them in CI will catch
integration issues earlier and prevent broken code from merging.

**Acceptance Criteria**

* GitHub Actions workflow created in .github/workflows/
* Integration tests run on every PR
* Tests run in isolated environment (kind cluster)
* Workflow completes in <10 minutes
* PR checks updated to require integration tests passing
* Documentation added for running tests locally

**Technical Details**

New file: .github/workflows/integration-tests.yaml

Tests to run:
* make test-integration

Environment setup:
* Create kind cluster
* Install CRDs
* Run test suite
* Cleanup

Reference existing workflow: .github/workflows/unit-tests.yaml
```

## Related

- [Story Guide](story.md) - Creating user stories for user-facing functionality
- [Epic Guide](epic.md) - Creating epics that contain tasks
- [Template Reference](../../templates/common/task.yaml) - Task template used by `/jira:create task`
