# Generated by Claude Sonnet 4.5 (Anthropic) - December 2025
#
# Common Bug Template
inherits: _base.yaml

name: common-bug
description: Base bug report template with reproduction steps and environment details
version: 1.0.0
created: 2025-01-08
author: openshift-eng

source:
  repository: "https://github.com/openshift-eng/ai-helpers"
  path: "plugins/jira/templates/common/bug.yaml"

documentation:
  guide: "../../docs/issue-types/bug.md"
  description: "Guide on bug reports: complete information, template, and best practices"

issue_type: Bug

defaults:
  labels:
    - ai-generated-jira
    - template:common-bug

# Common templates include project in display
display_format:
  - project
  - priority
  - severity
  - summary
  - assignee
  - status

description_template: |
  h4. Description of problem

  {{problem_description}}

  h4. Version-Release number

  {{version}}

  h4. How reproducible

  {{reproducibility}}

  h4. Steps to Reproduce

  {{#steps}}
  # {{.}}
  {{/steps}}

  h4. Actual results

  {{actual_results}}

  h4. Expected results

  {{expected_results}}
  {{#additional_context}}

  h4. Additional Context

  {{additional_context}}
  {{/additional_context}}

placeholders:
  - name: problem_description
    description: "Clear, detailed description of the problem"
    required: true
    type: multiline
    prompt_text: "What is the problem? Describe it clearly and in detail."
    help_text: |
      Provide context about the issue:
      - What were you trying to do?
      - What component or feature is affected?
      - Who is affected? How severe is it?
      - When did this start happening?
    examples:
      - "The kube-apiserver pod crashes immediately after upgrading a hosted control plane cluster from version 4.20 to 4.21. The pod enters CrashLoopBackOff state and all API requests to the cluster fail."
      - "The login button on the mobile app doesn't respond to taps on iOS devices. Users cannot proceed past the login screen."
    validation:
      min_length: 20
      max_length: 2000

  - name: version
    description: "Version where bug was found"
    required: true
    type: text
    prompt_text: "Which version exhibits this issue? (e.g., 4.21.0, 4.20.5)"
    help_text: |
      Include full version number if known.
      Specify component version if different from platform version.
      Note if issue affects multiple versions.
    examples:
      - "4.21.0"
      - "4.20.5"
      - "openshift-client-4.20.5"
    validation:
      max_length: 100

  - name: reproducibility
    description: "How often does this bug occur?"
    required: true
    prompt_type: options
    prompt_text: "How reproducible is this issue?"
    prompt_with_options:
      - value: "Always"
        description: "Happens every time following the steps"
      - value: "Sometimes"
        description: "Happens intermittently, even with same steps"
      - value: "Rarely"
        description: "Hard to reproduce, happened once or few times"
    default: "Always"
    help_text: |
      Select how often the bug occurs:
      - Always: Easiest to debug and fix
      - Sometimes: May be timing-related or race condition
      - Rarely: May be environmental or complex interaction

  - name: steps
    description: "Exact steps to reproduce the bug"
    required: true
    type: list
    prompt_text: "What are the exact steps to reproduce this issue? Be as specific as possible."
    validation:
      min_items: 1
      max_items: 20
    help_text: |
      Number each step and be precise:
      - Include exact commands with parameters
      - Mention button clicks, inputs
      - Include environment setup if needed
      - Use code blocks for commands
      - Specify timing (immediate, after 5 minutes, etc.)
    examples:
      - "Create a ROSA HCP cluster on version 4.20.0: rosa create cluster --name test-cluster --version 4.20.0 --hosted-cp"
      - "Wait for cluster to be fully ready (about 15 minutes)"
      - "Initiate upgrade to 4.21.0: rosa upgrade cluster --cluster test-cluster --version 4.21.0"
      - "Monitor the control plane pods: oc get pods -n clusters-test-cluster -w"
      - "Observe kube-apiserver pod status"

  - name: actual_results
    description: "What actually happens when you follow those steps?"
    required: true
    type: multiline
    prompt_text: "What actually happens when you follow those steps?"
    help_text: |
      Describe exactly what occurs:
      - Include full error messages (not paraphrased)
      - Mention symptoms (crashes, hangs, wrong output)
      - Include relevant logs or stack traces
      - Note timing (immediate, after 5 minutes, etc.)
    examples:
      - "The kube-apiserver pod crashes immediately after the upgrade completes. The pod restarts continuously (CrashLoopBackOff). Error in pod logs:\n\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x...]\n\nAPI requests to the cluster fail with:\nError from server: error dialing backend: dial tcp: lookup kube-apiserver: no such host"
    validation:
      min_length: 10
      max_length: 5000

  - name: expected_results
    description: "What should happen instead? What is the expected behavior?"
    required: true
    type: multiline
    prompt_text: "What should happen instead? What is the expected behavior?"
    help_text: |
      Describe the correct behavior:
      - State what should happen
      - Be specific about expected state/output
      - Contrast with actual results
    examples:
      - "The kube-apiserver pod should start successfully after the upgrade. The pod should be in Running state with 1/1 containers ready. API requests to the cluster should succeed normally."
      - "The button should respond to tap with visual feedback and navigate to the credentials input screen."
    validation:
      min_length: 10
      max_length: 2000

validation:
  summary:
    max_length: 100
