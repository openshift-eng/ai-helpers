# Generated by Claude Sonnet 4.5 (Anthropic) - December 2025
#
# Common Story Template
inherits: _base.yaml

name: common-story
description: Base story template with user story format and acceptance criteria
version: 1.0.0
created: 2025-01-08
author: openshift-eng

source:
  repository: "https://github.com/openshift-eng/ai-helpers"
  path: "plugins/jira/templates/common/story.yaml"

documentation:
  guide: "../../docs/issue-types/story.md"
  description: "Guide on user stories: format, acceptance criteria, best practices, and anti-patterns"

issue_type: Story

# Extend base defaults
defaults:
  labels:
    - ai-generated-jira
    - template:common-story

# Override display_format to include project (common templates span projects)
display_format:
  - project
  - priority
  - summary
  - assignee
  - status

description_template: |
  As a {{user_role}}, I want to {{action}}, so that {{value}}.

  h4. Acceptance Criteria

  {{#acceptance_criteria}}
  * {{.}}
  {{/acceptance_criteria}}
  {{#additional_context}}

  h4. Additional Context

  {{additional_context}}
  {{/additional_context}}

placeholders:
  - name: user_role
    description: "Who is the user or role that benefits from this story?"
    required: true
    type: text
    prompt_text: "Who is the user? (the person, role, or system that will benefit)"
    help_text: |
      Identify the specific user, role, device, or system that will benefit.
      Be specific - not just "user" but "cluster admin", "developer", "SRE team", "monitoring system".
    examples:
      - "cluster admin"
      - "developer"
      - "end user"
      - "SRE team"
      - "CI pipeline"
    validation:
      max_length: 50

  - name: action
    description: "What action or capability does the user want?"
    required: true
    type: text
    prompt_text: "What do they want to do? (the action or capability)"
    help_text: |
      Describe what the user can do with the system.
      Focus on the action, not the implementation.
      Use active voice and specific verbs.
    examples:
      - "configure automatic scaling policies"
      - "view real-time cluster metrics in the console"
      - "set up alerting rules for control plane health"
    validation:
      min_length: 10
      max_length: 200

  - name: value
    description: "Why does the user want this? What value or benefit do they get?"
    required: true
    type: text
    prompt_text: "Why do they want it? (the value, benefit, or purpose)"
    help_text: |
      Explain the value the user gains - the "so that" part.
      Should articulate clear benefit, not just restate the action.
      Focus on the outcome, not the feature.
    examples:
      - "I can handle traffic spikes without manual intervention"
      - "I can quickly identify performance issues before they impact users"
      - "I can be notified immediately when issues occur"
    validation:
      min_length: 10
      max_length: 200

  - name: acceptance_criteria
    description: "Conditions that must be satisfied for the story to be considered done"
    required: true
    type: list
    prompt_text: "What are the acceptance criteria? (one per line, 2-5 criteria recommended)"
    validation:
      min_items: 2
      max_items: 8
    help_text: |
      Acceptance criteria define "done" for this story.
      Each criterion should be testable and specific.
      Focus on behavior, not implementation.
      Typically 2-5 criteria per story.

      Choose format that fits:
      - "Test that <criteria>" (clear pass/fail conditions)
      - "Demonstrate that <this happens>" (user-visible features)
      - "Verify that when <role> does <action> they get <result>" (role-specific)
      - "Given <context> when <event> then <outcome>" (complex scenarios)
    examples:
      - "Test that node pools scale up when CPU exceeds 80%"
      - "Demonstrate that scaling policies can be configured via CLI"
      - "Verify that when a cluster admin sets max nodes to 10, the pool never exceeds 10 nodes"
      - "Given CPU utilization is at 85%, when the policy is active, then a new node is provisioned within 2 minutes"

# Story-specific validation
validation:
  summary:
    max_length: 100
    should_not_contain:
      - "As a"
      - "I want"
