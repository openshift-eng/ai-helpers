# Generated by Claude Sonnet 4.5 (Anthropic) - December 2025
#
# OCPBUGS Bug Template
inherits: common/bug.yaml

name: ocpbugs-bug
description: Bug template for OCPBUGS project with OpenShift-specific fields
version: 1.0.0
created: 2025-01-08
author: openshift-eng

source:
  repository: "https://github.com/openshift-eng/ai-helpers"
  path: "plugins/jira/templates/common/ocpbugs-bug.yaml"

project_key: OCPBUGS

defaults:
  labels:
    - ai-generated-jira
    - template:ocpbugs-bug

# Project-specific: omit 'project' from display
display_format:
  - priority
  - severity
  - summary
  - assignee
  - status

# Extend parent description with environment section
description_template: |
  h4. Description of problem

  {{problem_description}}

  h4. Version-Release number of selected component (if applicable)

  {{version}}

  h4. How reproducible

  {{reproducibility}}

  h4. Steps to Reproduce

  {{#steps}}
  # {{.}}
  {{/steps}}

  h4. Actual results

  {{actual_results}}

  h4. Expected results

  {{expected_results}}

  h4. Environment

  * Platform: {{platform}}
  * Cluster type: {{cluster_type}}
  {{#additional_context}}

  h4. Additional Context

  {{additional_context}}
  {{/additional_context}}

# Extend parent placeholders
placeholders:
  - name: problem_description
    description: "Clear description of the problem"

  - name: version
    description: "OpenShift version (e.g., 4.17.0, 4.18.0-rc.1)"

  - name: reproducibility
    description: "How often does this occur? (Always/Sometimes/Rarely)"

  - name: steps
    description: "Steps to reproduce (one per line)"

  - name: actual_results
    description: "What actually happens? Include error messages."

  - name: expected_results
    description: "What should happen instead?"

  - name: additional_context
    description: "Logs, must-gather output, workarounds"
    prompt_text: "Any additional context? (logs, must-gather output, workarounds, related issues)"
    help_text: |
      For bugs, focus on diagnostic information:
      - Logs (pod logs, operator logs)
      - must-gather output
      - Workarounds (if any)
      Also include: related issues, design docs if applicable.

  - name: platform
    description: "Platform (AWS/Azure/GCP/vSphere/BareMetal/etc.)"
    required: false
    default: "Not specified"

  - name: cluster_type
    description: "Cluster type (SNO/Compact/Standard/HyperShift/etc.)"
    required: false
    default: "Standard"

  - name: target_version
    description: "Target version for fix (OpenShift version format)"
    required: true
    field: customfield_12319940
    prompt_text: "Which OpenShift version should this be fixed in? (e.g., 4.22, openshift-4.22)"
    help_text: |
      Specify the OpenShift version where the fix should be targeted.
      Input will be normalized to openshift-X.Y format.
      Examples: 4.22, OCP 4.21, openshift-4.23

  - name: component
    description: "Component affected by this bug"
    required: true
    prompt_type: options
    prompt_text: "Which component does this bug affect?"
    prompt_with_options:
      - value: "HyperShift / ARO"
        description: "ARO HCP (Azure Red Hat OpenShift Hosted Control Planes)"
        keywords:
          - pattern: ["aro", "azure", "aro hcp"]
      - value: "HyperShift / ROSA"
        description: "ROSA HCP (Red Hat OpenShift Service on AWS Hosted Control Planes)"
        keywords:
          - pattern: ["rosa", "aws", "rosa hcp"]
      - value: "HyperShift"
        description: "Platform-agnostic HyperShift or affects both ARO and ROSA"
        keywords:
          - pattern: ["hypershift", "multi-cloud", "platform-agnostic", "both platforms", "all platforms"]
            confirm: true
      - value: "Two Node Fencing"
        description: "Two-node cluster with fencing-based HA"
        keywords:
          - pattern: ["pacemaker", "DualReplica"]
      - value: "Two Node Arbiter"
        description: "Two-node cluster with arbiter-based HA"
        keywords:
          - pattern: ["arbiter", "HighlyAvailableArbiter"]
    auto_detect:
      search_in: ["summary", "description"]
    help_text: |
      Select the component this bug affects. Common components include:
      - HyperShift / ARO: Azure-specific HyperShift issues
      - HyperShift / ROSA: AWS-specific HyperShift issues
      - HyperShift: Platform-agnostic HyperShift
      - Two Node Fencing: Two-node HA and fencing
      - Two Node Arbiter: Two-node with arbiter

      If your component is not listed, select "Other" to enter it manually.
      Component is auto-detected from keywords in summary/description.

component_field: "{{component}}"

jira_fields:
  versions:
    source: version
    required: true
  components:
    required: true
    prompt_if_missing: true

validation:
  summary:
    max_length: 100
  version:
    required: true
